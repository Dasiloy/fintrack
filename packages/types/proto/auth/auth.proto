syntax = "proto3";

package auth;

service AuthService {
    rpc Register(RegisterReq) returns (RegisterRes) {}
    rpc VerifyEmail(VerifyEmailReq) returns (VerifyEmailRes) {}
    rpc ResendVerifyEmailToken(ResendVerifyEmailTokenReq) returns (ResendVerifyEmailTokenRes) {}
    rpc Login(LoginReq) returns (LoginRes) {}
    rpc ForgotPassword(ForgotPasswordReq) returns (ForgotPasswordRes) {}
    rpc ResendForgotPasswordToken(ResendForgotPasswordTokenReq) returns (ResendForgotPasswordTokenRes) {}
    rpc ValidateToken(ValidateTokenReq) returns (ValidateTokenRes) {}
    rpc RefreshToken(RefreshTokenReq) returns (RefreshTokenRes) {}
}

message User {
    string id=1;
    string email= 2;
    optional string avatar= 3;
    string firstName= 4;
    string lastName= 5;
}

message RegisterReq {
    string email= 1;
    string password= 2;
    string firstName= 3;
    string lastName= 4;
}

message RegisterRes {
     User user= 1;
     string emailToken= 2;
}

message VerifyEmailReq {
    string otp= 1;
}

message VerifyEmailRes {
    User user= 1;
    string accessToken= 2;
    string refreshToken= 3;
}

message ResendVerifyEmailTokenReq {
    string email= 1;
}

message ResendVerifyEmailTokenRes {
    User user= 1;
    string emailToken= 2;
}

message LoginReq {
 string email= 1;
 string password= 2;
}

message LoginRes {
    User user= 1;
    string accessToken= 2;
    string refreshToken= 3;
}

message ForgotPasswordReq {
    string email= 1;
}

message ForgotPasswordRes {
    string email= 1;
    string forgotPasswordToken= 2;
}

message ResendForgotPasswordTokenReq {
    string email= 1;
}

message ResendForgotPasswordTokenRes {
    string email= 1;
    string forgotPasswordToken= 2;
}

message ValidateTokenReq {
    
}

message ValidateTokenRes {
    string id=1;
    string email= 2;
    string avatar= 3;
    string firstName= 4;
    string lastName= 5;
}

message RefreshTokenReq {
    string refreshToken= 1;
}

message RefreshTokenRes {
    string accessToken= 2;
    string refreshToken= 3;
}




